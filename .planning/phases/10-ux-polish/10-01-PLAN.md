---
phase: 10-ux-polish
plan: 1
type: execute
---

<objective>
Add 404 error page and full screen image viewer for inline content images.

Purpose: Improve user experience with proper error handling and enhanced image interaction for case study and article content.
Output: Custom 404 page component, modal image viewer with keyboard navigation and accessibility features.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Prior phase context:**
- Phase 9 added real content with inline images in markdown (![](./path/to/image.png))
- Images are rendered in `.prose` container via Astro's Content component
- Existing components: HeroImage.astro, ResponsiveImage.astro for hero/cover images
- Design system uses CSS custom properties for colors, spacing, transitions

**Requirements from IMPROVEMENTS.md:**
- Full screen image viewer for inline content images
- Click image to expand to full screen modal
- ESC key to close, click outside to close
- Smooth transitions/animations
- Accessibility (focus trap, screen reader announcements)

@.planning/phases/10-ux-polish/IMPROVEMENTS.md
@src/pages/work/[...slug].astro
@src/pages/writing/[...slug].astro
@src/layouts/BaseLayout.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create 404 error page</name>
  <files>src/pages/404.astro</files>
  <action>
    Create custom 404 page following project design system:
    - Use BaseLayout with title="Page Not Found"
    - Centered content container with helpful message
    - "The page you're looking for doesn't exist or has been moved."
    - Links to: Home (/), Work (/work), Writing (/writing)
    - Match existing page styling (consistent with about.astro, contact.astro)
    - Use semantic HTML (main, h1, p, nav)
    - Apply design tokens (--color-text, --space-* for margins)
  </action>
  <verify>
    - npm run build succeeds
    - Visit http://localhost:4321/nonexistent-page shows 404 page
    - Links navigate correctly
  </verify>
  <done>404.astro exists, builds without errors, renders with proper styling and navigation</done>
</task>

<task type="auto">
  <name>Task 2: Create full screen image viewer component</name>
  <files>src/components/ImageViewer.astro, src/scripts/imageViewer.ts, src/layouts/BaseLayout.astro</files>
  <action>
    Implement modal image viewer for inline prose images:

    **ImageViewer.astro component:**
    - Modal overlay with semi-transparent dark background (rgba(0,0,0,0.9))
    - Centered image with max-width: 90vw, max-height: 90vh
    - Close button (X) in top-right corner
    - Hidden by default (display: none), shown via .active class
    - Uses role="dialog", aria-modal="true", aria-label="Image viewer"

    **imageViewer.ts script:**
    - Add click listeners to all `.prose img` elements on page load
    - On image click: show modal, set src to clicked image, focus trap to modal
    - ESC key closes modal (keydown event listener)
    - Click on overlay (not image) closes modal
    - Close button click closes modal
    - Focus management: save previous focus, return on close
    - Screen reader announcement when opening/closing

    **BaseLayout.astro integration:**
    - Import and include ImageViewer component at end of body
    - Import imageViewer.ts script with `is:inline` to run on every page
    - Only activates on pages with prose images (case studies, articles)

    **Styling:**
    - Smooth fade transitions (opacity 0.3s ease)
    - No body scroll when modal open (overflow: hidden on body)
    - Z-index above all content (z-index: 1000)
    - Cursor: pointer on prose images to indicate clickability
    - Image hover effect in prose (subtle opacity change)

    **Accessibility:**
    - Focus trap within modal (tab cycles through close button and image)
    - aria-hidden on main content when modal open
    - Keyboard navigation (Tab, Shift+Tab, ESC)
    - Screen reader announces "Image viewer opened" / "Image viewer closed"
  </action>
  <verify>
    - npm run build succeeds, no TypeScript errors
    - Click any inline image in case study opens modal
    - ESC key closes modal
    - Click outside image closes modal
    - Close button works
    - No console errors
  </verify>
  <done>ImageViewer component exists, integrates with BaseLayout, prose images are clickable, modal opens/closes correctly with keyboard support</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>404 error page and full screen image viewer with keyboard navigation</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Test 404 page:
       - Visit: http://localhost:4321/invalid-page
       - Confirm: Custom 404 message displays, links to Home/Work/Writing work
    3. Test image viewer on case study:
       - Visit: http://localhost:4321/work/ds-bridge
       - Click any inline image (not hero image)
       - Confirm: Modal opens with full screen image, dark overlay
       - Press ESC: Modal closes
       - Click image again, then click dark background: Modal closes
       - Click image again, then click X button: Modal closes
    4. Test accessibility:
       - Open modal, press Tab: Focus moves to close button
       - Press Tab again: Focus stays in modal (no escape)
       - Press ESC: Modal closes, focus returns to page
    5. Check responsive:
       - Resize browser to mobile (375px): Image fits within viewport
       - Image doesn't overflow or cause horizontal scroll
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds without errors
- [ ] 404 page renders correctly at /invalid-page
- [ ] Image viewer modal opens on prose image click
- [ ] ESC, click outside, and close button all close modal
- [ ] No accessibility warnings in browser console
- [ ] Focus returns to page after modal closes
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- 404 page styled consistently with site design
- Image viewer works smoothly with keyboard navigation
- Accessibility features (focus trap, screen reader) functional
- No regressions to existing pages
</success_criteria>

<output>
After completion, create `.planning/phases/10-ux-polish/10-01-SUMMARY.md`:

# Phase 10 Plan 1: Error Handling & Image Viewer Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- Custom 404 error page with helpful navigation
- Full screen image viewer for inline content images
- Keyboard navigation and accessibility features

## Files Created/Modified

- `src/pages/404.astro` - Custom error page
- `src/components/ImageViewer.astro` - Modal component
- `src/scripts/imageViewer.ts` - Image viewer logic
- `src/layouts/BaseLayout.astro` - Integrated viewer component

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 10-02-PLAN.md (Page transitions and accessibility audit)
</output>
