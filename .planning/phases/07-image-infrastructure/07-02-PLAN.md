---
phase: 07-image-infrastructure
plan: 2
type: execute
---

<objective>
Create responsive image components and integrate with existing case study cards.

Purpose: Enable optimized, responsive image rendering across the portfolio using Astro's built-in Image and Picture components.
Output: Reusable image components with responsive layouts, CaseStudyCard updated to display cover images, writing integration ready.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-image-infrastructure/DISCOVERY.md
@.planning/phases/07-image-infrastructure/07-01-SUMMARY.md

**Prior decisions affecting this phase:**
- Design system with warm color palette and slate blue accent (Phase 2)
- CaseStudyCard component with subtle hover animation (Phase 4)
- Editorial feel with calm, minimal aesthetic (PROJECT.md)

**Discovery findings:**
- Use Astro's built-in <Image /> and <Picture /> components
- Enable responsive images with layout prop
- Include width/height to minimize CLS (Cumulative Layout Shift)
- Use lazy loading for below-fold images
- Support WebP/AVIF formats for better compression

**Relevant source files:**
@src/components/CaseStudyCard.astro
@src/content/config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create responsive image components</name>
  <files>
src/components/ResponsiveImage.astro,
src/components/HeroImage.astro
  </files>
  <action>
Create two reusable image components using Astro's built-in image optimization:

**ResponsiveImage.astro** - General purpose responsive images:
- Wraps Astro's <Image /> component
- Props: src (ImageMetadata), alt (string), loading (eager|lazy, default lazy), class (string, optional)
- Default layout="responsive" for automatic srcset/sizes
- Include width/height from image metadata to prevent CLS
- Apply any passed class for styling flexibility

**HeroImage.astro** - Hero/cover images with multiple formats:
- Wraps Astro's <Picture /> component
- Props: src (ImageMetadata), alt (string), widths (number[], default [400, 800, 1200]), class (string, optional)
- formats={['avif', 'webp', 'jpg']} for progressive enhancement
- sizes attribute: "(max-width: 640px) 100vw, (max-width: 1024px) 80vw, 1200px"
- Include width/height for CLS prevention

Both components should be minimal wrappers that leverage Astro's built-in optimization. Add brief JSDoc comments explaining usage.

Use Astro's image imports (not strings) - images passed as props should be ImageMetadata type from importing via src={import('./image.jpg')}.
  </action>
  <verify>
- Files created in src/components/
- npm run build succeeds
- Components use Astro's Image/Picture components correctly
- TypeScript types are correct for props
  </verify>
  <done>
- ResponsiveImage.astro wraps <Image /> with responsive defaults
- HeroImage.astro wraps <Picture /> with format optimization
- Components accept proper ImageMetadata types
- Build succeeds with no errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Update CaseStudyCard to display cover images</name>
  <files>src/components/CaseStudyCard.astro</files>
  <action>
Update CaseStudyCard.astro to display cover images when available:

1. Import ResponsiveImage component at top of file
2. Check if entry.data.coverImage exists (it's optional)
3. If coverImage exists, render ResponsiveImage before title/description:
   - Use ResponsiveImage component
   - src={entry.data.coverImage}
   - alt={entry.data.title}
   - loading="lazy" (cards are often below fold)
   - Add rounded corners and subtle styling to match editorial feel
4. If no coverImage, render existing card layout unchanged
5. Ensure image aspect ratio doesn't break card layout
6. Apply subtle styling: border-radius, maintain spacing consistency

Style integration:
- Image should feel integrated with card design
- Maintain existing hover animation (translateY -2px)
- Use design system values (border-radius from Phase 2 if defined, otherwise 8px)
- Ensure proper spacing between image and text content

Handle missing images gracefully - no broken image icons, just skip the image section.
  </action>
  <verify>
- Build succeeds: npm run build
- CaseStudyCard displays images when coverImage present
- Cards without images render normally (backward compatible)
- Hover animation still works
- No layout shift or broken images
  </verify>
  <done>
- CaseStudyCard renders cover images using ResponsiveImage
- Graceful fallback when no image present
- Styling integrated with existing card design
- Maintains hover animation and editorial feel
- Build passes with no errors
  </done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] npm run build succeeds without errors
- [ ] ResponsiveImage and HeroImage components created
- [ ] CaseStudyCard displays images when available
- [ ] No TypeScript errors
- [ ] Image optimization working (check build output for optimized images)
- [ ] Graceful handling of missing images
</verification>

<success_criteria>
- ResponsiveImage and HeroImage components created and functional
- CaseStudyCard updated to display cover images
- Image optimization pipeline working (Sharp processing at build)
- Backward compatible with content lacking images
- All builds and type checks pass
- ISS-001 (Image usage and optimization strategy) resolved
</success_criteria>

<output>
After completion, create `.planning/phases/07-image-infrastructure/07-02-SUMMARY.md`:

# Phase 7 Plan 2: Image Components and Integration Summary

**[One-liner about what shipped]**

## Accomplishments

- Created ResponsiveImage and HeroImage components wrapping Astro's built-in optimization
- Integrated cover image display into CaseStudyCard component
- Enabled responsive, optimized image rendering across portfolio

## Files Created/Modified

- `src/components/ResponsiveImage.astro` - General responsive image component
- `src/components/HeroImage.astro` - Hero image with format optimization
- `src/components/CaseStudyCard.astro` - Updated to display cover images

## Decisions Made

- Used Astro's built-in Image/Picture components (no external dependencies)
- Enabled lazy loading by default for cards (below-fold optimization)
- Set responsive layout with automatic srcset/sizes generation
- Supported AVIF/WebP/JPG formats for progressive enhancement
- Made image display optional (graceful degradation)

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 7 complete. Ready for Phase 8: Brand Identity.

**Issue addressed:** ISS-001 (Image usage and optimization strategy) - resolved with repo-based storage and Astro built-in optimization.
</output>
