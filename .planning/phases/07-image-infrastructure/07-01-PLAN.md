---
phase: 07-image-infrastructure
plan: 1
type: execute
---

<objective>
Establish image schema and storage foundation for content collections.

Purpose: Enable type-safe image references in case studies and writing content with proper directory structure for optimized images.
Output: Updated content collections schema with image() helper, organized image directories with sample images for testing.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-image-infrastructure/DISCOVERY.md

**Prior decisions affecting this phase:**
- Astro framework with content collections (Phase 1)
- Markdown + frontmatter for content (Init)
- GitHub Pages hosting (Phase 6)

**Discovery findings:**
- Astro v5 has built-in Sharp image optimization (no external integration needed)
- Use image() helper in schema for type-safe imports
- Store images in src/content/[collection]/images/ for automatic optimization
- Repository storage recommended over CDN for portfolio scale

**Relevant source files:**
@src/content/config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update content collections schema with image support</name>
  <files>src/content/config.ts</files>
  <action>
Import image helper from 'astro:content'. Update caseStudies collection schema to add coverImage field using image() helper (optional, for backward compatibility). Update writing collection schema to add coverImage field using image() helper (optional). Keep all existing fields unchanged.

Example pattern:
```typescript
import { defineCollection, z, image } from 'astro:content';

const caseStudies = defineCollection({
  type: 'content',
  schema: ({ image }) => z.object({
    // existing fields...
    coverImage: image().optional(),
  }),
});
```

Do NOT use z.string() for image field - use the image() helper which validates and auto-imports images.
  </action>
  <verify>
- Build succeeds: npm run build
- Type checking passes: npx astro check
- Schema exports image() helper for both collections
  </verify>
  <done>
- Content collections schema includes coverImage field using image() helper
- Optional field maintains backward compatibility with existing content
- No TypeScript errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Create image directory structure with sample images</name>
  <files>
src/content/case-studies/images/.gitkeep,
src/content/writing/images/.gitkeep,
src/content/case-studies/images/sample-cover.jpg,
src/content/writing/images/sample-cover.jpg
  </files>
  <action>
Create directories src/content/case-studies/images/ and src/content/writing/images/. Add .gitkeep files to both directories to ensure they're tracked by git.

Create simple placeholder images for testing:
- Use ImageMagick or similar to generate 1200x630 placeholder JPGs (common OG image size)
- Label them clearly as samples: "Sample Cover Image - Replace Me"
- Neutral color (gray or slate blue from design system)
- File names: sample-cover.jpg in each directory

If ImageMagick not available, use any method to create simple solid-color JPG placeholders (can use online tool, save from browser canvas, etc.).

These are temporary test assets to validate the image pipeline - real images come in Phase 9.
  </action>
  <verify>
- Directories exist: ls src/content/case-studies/images/ src/content/writing/images/
- Sample images exist and are valid JPGs
- Files are under 200KB each (reasonable for placeholders)
  </verify>
  <done>
- Image directories created in both collections
- .gitkeep files ensure directories are tracked
- Sample placeholder images available for testing
- Images are valid format and reasonable size
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds without errors
- [ ] npx astro check passes type checking
- [ ] Content collections schema updated with image() helper
- [ ] Image directories exist with sample files
- [ ] No warnings or deprecation notices
</verification>

<success_criteria>
- Content collections schema supports coverImage field using image() helper
- Image directory structure established for both collections
- Sample placeholder images available for testing
- All builds and type checks pass
- Backward compatible with existing content (optional field)
</success_criteria>

<output>
After completion, create `.planning/phases/07-image-infrastructure/07-01-SUMMARY.md`:

# Phase 7 Plan 1: Image Schema and Storage Summary

**[One-liner about what shipped]**

## Accomplishments

- Updated content collections schema with image() helper for type-safe image imports
- Created organized image directory structure for case studies and writing
- Added sample placeholder images for testing pipeline

## Files Created/Modified

- `src/content/config.ts` - Added coverImage field with image() helper
- `src/content/case-studies/images/` - New directory with sample image
- `src/content/writing/images/` - New directory with sample image

## Decisions Made

- Used image() helper (not z.string()) for proper type safety and auto-imports
- Made coverImage optional to maintain backward compatibility
- Stored images in collection subdirectories for organization
- Created simple placeholders (1200x630 JPG) for testing

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 07-02-PLAN.md - Image Components and Integration
</output>
