---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const allCaseStudies = await getCollection('case-studies');
const sortedCaseStudies = allCaseStudies.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

const pageTitle = 'Work';
const pageDescription = 'Case studies and projects showcasing product design work in AI and blockchain innovation.';
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <div class="container">
    <header class="work-header">
      <h1>Work</h1>
      <p class="intro">Case studies showcasing product design work in AI and blockchain innovation.</p>
    </header>

    {sortedCaseStudies.length === 0 ? (
      <p class="empty-state">No case studies available yet. Check back soon.</p>
    ) : (
      <ul class="case-study-list">
        {sortedCaseStudies.map((caseStudy) => (
          <li class="case-study-item">
            <div class="case-study-header">
              <h2>
                <a href={`/work/${caseStudy.slug}`}>{caseStudy.data.title}</a>
              </h2>
              {caseStudy.data.confidentiality !== 'public' && (
                <span class={`badge badge-${caseStudy.data.confidentiality}`}>
                  {caseStudy.data.confidentiality === 'partial' ? 'Limited Detail' : 'NDA Protected'}
                </span>
              )}
            </div>
            <p class="description">{caseStudy.data.description}</p>
            <time class="date" datetime={caseStudy.data.date.toISOString()}>
              {caseStudy.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
            </time>
          </li>
        ))}
      </ul>
    )}
  </div>
</BaseLayout>

<style>
  .work-header {
    margin-bottom: var(--space-12);
  }

  .intro {
    font-size: var(--text-lg);
    color: var(--color-text-muted);
    max-width: var(--max-width-content);
    margin-bottom: 0;
  }

  .empty-state {
    color: var(--color-text-muted);
    font-style: italic;
  }

  .case-study-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .case-study-item {
    padding-bottom: var(--space-8);
    margin-bottom: var(--space-8);
    border-bottom: 1px solid var(--color-border);
  }

  .case-study-item:last-child {
    border-bottom: none;
    margin-bottom: 0;
  }

  .case-study-header {
    display: flex;
    align-items: baseline;
    gap: var(--space-3);
    flex-wrap: wrap;
  }

  .case-study-item h2 {
    font-size: var(--text-2xl);
    margin-bottom: var(--space-2);
    font-weight: var(--font-semibold);
  }

  .case-study-item h2 a {
    color: var(--color-text);
    text-decoration: none;
  }

  .case-study-item h2 a:hover {
    color: var(--color-accent);
    text-decoration: none;
  }

  .description {
    color: var(--color-text-muted);
    margin-bottom: var(--space-2);
  }

  .date {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }

  .badge {
    display: inline-block;
    font-size: var(--text-xs);
    font-weight: var(--font-medium);
    padding: var(--space-1) var(--space-2);
    border-radius: 4px;
    text-transform: uppercase;
    letter-spacing: var(--tracking-wide);
  }

  .badge-partial {
    background-color: var(--color-surface-hover);
    color: var(--color-text-muted);
  }

  .badge-nda {
    background-color: var(--color-surface-hover);
    color: var(--color-text);
  }
</style>
